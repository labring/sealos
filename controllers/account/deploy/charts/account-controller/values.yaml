# Default values for account controller helm chart.

image: ghcr.io/labring/sealos-account-controller:latest
imagePullPolicy: Always

imagePullSecrets: []
nameOverride: ""
fullnameOverride: "account-controller"

serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: "account-controller-manager"

podAnnotations: {}
podLabels: {}

podSecurityContext:
  runAsNonRoot: true

securityContext:
  allowPrivilegeEscalation: false
  runAsNonRoot: true

service:
  metrics:
    port: 8443
  webhook:
    port: 443

env:
  accountNamespace: sealos-system
  userNamespace: user-system
  whitelist: "licenses.License.license.sealos.io/v1,notifications.Notification.notification.sealos.io/v1,payments.Payment.account.sealos.io/v1,billingrecordqueries.BillingRecordQuery.account.sealos.io/v1,billinginfoqueries.BillingInfoQuery.account.sealos.io/v1,pricequeries.PriceQuery.account.sealos.io/v1"

# ============================================================================
# Auto-configured values (from sealos-system/sealos-config ConfigMap)
# ============================================================================
# The following accountEnv values are automatically fetched from the
# sealos-system/sealos-config ConfigMap by the entrypoint script and will
# override any values set here. These are provided as reference defaults.
#
# To override these auto-configured values, use HELM_OPTIONS or modify the
# sealos-config ConfigMap directly.
# ============================================================================

accountEnv:
  # Basic cloud configuration (auto-configured from sealos-config)
  cloudDomain: "cloud.sealos.io"  # Auto-fetched from sealos-config.cloudDomain
  cloudPort: ""                   # Auto-fetched from sealos-config.cloudPort
  localRegion: ""                 # Auto-fetched from sealos-config.regionUID

  # Database connections (auto-configured from sealos-config)
  mongoURI: "mongodb://mongo:27017/resources"  # Auto-fetched from sealos-config.databaseMongodbURI
  globalCockroachURI: ""                      # Auto-fetched from sealos-config.databaseGlobalCockroachdbURI
  localCockroachURI: ""                       # Auto-fetched from sealos-config.databaseLocalCockroachdbURI
  trafficMongoURI: ""                         # Auto-fetched from sealos-config.databaseMongodbURI

  # Authentication secrets (auto-configured from sealos-config)
  accountApiJwtSecret: "secret"  # Auto-fetched from sealos-config.jwtInternal

  # Kubernetes API whitelist (auto-generated from cloudDomain)
  whitelistKubernetesHosts: ""  # Auto-generated: https://${cloudDomain}:6443

# End of auto-configured values
# ============================================================================

# ConfigMap 合并策略: preserve 保留旧值, overwrite 覆盖旧值
accountEnvMergeStrategy: "overwrite"

paymentSecretName: payment-secret

livenessProbe:
  httpGet:
    path: /healthz
    port: 8081
  initialDelaySeconds: 15
  periodSeconds: 20

readinessProbe:
  httpGet:
    path: /readyz
    port: 8081
  initialDelaySeconds: 5
  periodSeconds: 10

metrics:
  ## To enable this parameter, it needs to be enabled in the subsequent code; otherwise, it cannot be started
  enabled: false
  certPath: /tmp/k8s-metrics-server/metrics-certs
  secretName: metrics-server-cert

volumes: []
volumeMounts: []

nodeSelector: {}

tolerations: []

# If no affinity is provided a default podAntiAffinity is used to spread controllers.
affinity: {}
